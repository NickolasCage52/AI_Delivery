# E2E Checklist: Отправка заявок в Telegram

Чеклист для ручной проверки всех форм. Заявки должны доходить в Telegram чат, UI — единый.

---

## Подготовка

- [ ] `TELEGRAM_BOT_TOKEN` и `TELEGRAM_CHAT_ID` заданы в `.env.local`
- [ ] `npm run build && npm run start` — green
- [ ] Открыть DevTools → Network, фильтр XHR/Fetch

---

## Формы

### 1. Главная страница `/` — CTA секция (#contact)

- [ ] Заполнить форму (имя, контакт, ниша, задача, сроки)
- [ ] Отправить
- [ ] Network: `POST /api/lead` → 200 OK
- [ ] Сообщение появилось в Telegram чат
- [ ] Success: «Спасибо! Мы свяжемся с вами в ближайшее время» + redirect на `/thank-you`
- [ ] При ошибке: FormStatus с текстом «Не удалось отправить...» + ссылка «Оставить заявку в Telegram»

### 2. Страница `/demo` — DemoForm

- [ ] Заполнить форму (имя, контакт, улучшить, бардак, задача), чекбокс
- [ ] Отправить
- [ ] Network: 200 OK
- [ ] Сообщение в Telegram
- [ ] Redirect на `/thank-you`
- [ ] При ошибке: FormStatus + ссылка на Telegram

### 3. Страница `/contact` — ContactForm

- [ ] Заполнить форму
- [ ] Отправить
- [ ] Network: 200 OK
- [ ] Сообщение в Telegram
- [ ] Redirect на `/thank-you`
- [ ] При ошибке: FormStatus + ссылка на Telegram

### 4. Модальная форма (LeadModal) — глобально

- [ ] Нажать «Разобрать задачу» / аналогичную кнопку
- [ ] Заполнить модалку (имя, контакт, что нужно)
- [ ] Отправить
- [ ] Network: 200 OK
- [ ] Сообщение в Telegram
- [ ] Success блок: «Спасибо!» + кнопка «Перейти на страницу Спасибо»
- [ ] При ошибке: FormStatus в модалке + ссылка на Telegram

### 5. Inline форма (главная, TimelineScene и т.д.)

- [ ] Заполнить имя и контакт
- [ ] Отправить
- [ ] Network: 200 OK
- [ ] Сообщение в Telegram
- [ ] Success: «Спасибо!» + «Отправить ещё»
- [ ] При ошибке: FormStatus + ссылка на Telegram

### 6. Страница `/cases` — CTAFormBlock

- [ ] Заполнить имя, контакт, сообщение
- [ ] Отправить
- [ ] Network: 200 OK
- [ ] Сообщение в Telegram
- [ ] Success: «Заявка отправлена. Мы свяжемся в течение 24 часов.»
- [ ] При ошибке: FormStatus + ссылка на Telegram

---

## Офлайн и сбои

- [ ] Отключить сеть → отправить форму
- [ ] Ожидаемо: сообщение «Нет соединения» или «Превышено время ожидания» + «Оставить заявку в Telegram»
- [ ] Включить сеть → повторная отправка работает

---

## Идентификация заявок

- [ ] В логах сервера (или с `LEAD_DEBUG=1`) виден `leadId` для каждой заявки
- [ ] Можно сопоставить leadId в логах с заявкой в Telegram
